(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{166:function(e,t,a){},237:function(e,t,a){e.exports=a(522)},306:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},307:function(e,t,a){},325:function(e,t){},327:function(e,t){},359:function(e,t){},360:function(e,t){},429:function(e,t){},522:function(e,t,a){"use strict";a.r(t);a(238),a(278),a(280),a(282);var n=a(0),i=a.n(n),l=a(135),s=a.n(l),r=a(524),o=a(525),u=(a(166),a(39)),c=a(40),p=a(42),m=a(41),d=a(43),f=a(523),h=a(44),b=a.n(h),g=(a(306),a(307),i.a.Component,a(8)),y=(a(311),function(e){function t(e,a){var n;Object(u.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e,a))).createMenu=n.createMenu.bind(Object(g.a)(Object(g.a)(n))),n.setFileName=n.setFileName.bind(Object(g.a)(Object(g.a)(n))),n.saveImage=n.saveImage.bind(Object(g.a)(Object(g.a)(n))),n.pushMessage=n.pushMessage.bind(Object(g.a)(Object(g.a)(n))),n.getUserId=n.getUserId.bind(Object(g.a)(Object(g.a)(n)));new window.VConsole;return n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"setFileName",value:function(){var e=document.getElementById("groupBuyImage").files[0].name;document.getElementsByClassName("custom-file-label")[0].innerHTML=e}},{key:"getUserId",value:function(){return new Promise(function(e,t){window.liff.init(function(t){var a=t.context.userId;console.log(a),e(a)},function(e){t("error occur")})})}},{key:"createMenu",value:function(){console.log("in create menu");var e=this,t="";e.getUserId().then(function(a){return t=a,e.saveImage()}).then(function(a){var n=a.data;return console.log(n),e.pushMessage(n,t)}).then(function(){window.liff.closeWindow()})}},{key:"saveImage",value:function(){var e=new FormData;return e.append("image",document.getElementById("groupBuyImage").files[0]),b.a.post("/api/putImageToFtp",e,{headers:{"Content-Type":"multipart/form-data"}})}},{key:"pushMessage",value:function(e,t){return b.a.post("/api/pushMessage",{user_id:t,message:{type:"flex",altText:"\u5718\u8cfc\u529f\u80fd",contents:{type:"bubble",hero:{type:"image",url:e,size:"full",aspectRatio:"20:13",aspectMode:"cover",action:{type:"uri",uri:"http://linecorp.com/"}},footer:{type:"box",layout:"vertical",spacing:"sm",contents:[{type:"button",style:"link",height:"sm",action:{type:"uri",label:"\u5efa\u7acb\u5718\u8cfc",uri:"http://www.google.com"}},{type:"button",style:"link",height:"sm",action:{type:"uri",label:"\u5718\u8cfc\u5217\u8868",uri:"http://www.google.com"}},{type:"spacer",size:"sm"}],flex:0}}}})}},{key:"render",value:function(){return i.a.createElement("div",{className:"container mt-3"},i.a.createElement("p",null)," ",i.a.createElement("p",null),i.a.createElement("div",{className:"fileinput fileinput-new","data-provides":"fileinput"},i.a.createElement("div",{className:"fileinput-preview thumbnail","data-trigger":"fileinput",style:{width:"200px",height:"150px"}}),i.a.createElement("div",null,i.a.createElement("span",{className:"btn btn-default btn-file"},i.a.createElement("span",{className:"fileinput-new"},"\u9078\u64c7\u5716\u6a94"),i.a.createElement("span",{className:"fileinput-exists"},"\u91cd\u65b0\u9078\u64c7"),i.a.createElement("input",{type:"file",id:"groupBuyImage"})),i.a.createElement("a",{href:"#",className:"btn btn-default fileinput-exists","data-dismiss":"fileinput"},"\u79fb\u9664"))),i.a.createElement("div",{class:"mt-3"},i.a.createElement("button",{class:"btn btn-primary",onClick:this.createMenu},"\u5efa\u7acb\u5718\u8cfc")))}}]),t}(i.a.Component)),v=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){this.props.match.params.userId;return i.a.createElement("div",null,i.a.createElement("h1",null,"\u8a02\u8cfc"))}}]),t}(i.a.Component),w=function(e){function t(e,a){var n;Object(u.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e,a))).updateGroupIds=n.updateGroupIds.bind(Object(g.a)(Object(g.a)(n))),n.saveImage=n.saveImage.bind(Object(g.a)(Object(g.a)(n))),n.pushMessageToGroups=n.pushMessageToGroups.bind(Object(g.a)(Object(g.a)(n))),n.createGroupBuy=n.createGroupBuy.bind(Object(g.a)(Object(g.a)(n)));new window.VConsole;n.state={tableHtml:[],sendGroupIds:[],user:{id:"",displayName:"",pictureUrl:""}};var i=Object(g.a)(Object(g.a)(n));return window.liff.init(function(e){window.getProfile().then(function(e){console.log("profile = "),console.log(e),i.state.user.id=e.userId,i.state.user.displayName=e.displayName,i.state.user.pictureUrl=e.pictureUrl})}),n.findUserGroups(),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getUserId",value:function(){return new Promise(function(e,t){window.liff.init(function(t){console.log(" data.context = "),console.log(t.context);var a=t.context.userId;e(a)},function(e){t("error occur")})})}},{key:"findUserGroups",value:function(){var e=this,t={params:{user_id:this.state.user.id}};b.a.get("/api/getUserGroups",t).then(function(t){e.createTableHtml(t.data),console.log(t.data)})}},{key:"createTableHtml",value:function(e){var t=[];t.push(i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null),i.a.createElement("th",null,"\u7fa4\u7d44\u540d\u7a31"))));for(var a=[],n=0;n<e.length;n++){var l=[];l.push(i.a.createElement("td",null,i.a.createElement("input",{type:"checkbox",value:e[n].group_id,onChange:this.updateGroupIds}))),l.push(i.a.createElement("td",null,e[n].group_name)),a.push(i.a.createElement("tr",null,l))}t.push(i.a.createElement("tbody",null,a)),this.setState({tableHtml:t})}},{key:"updateGroupIds",value:function(e){var t=e.target.checked,a=this.state.sendGroupIds,n=e.target.value;t?-1==a.indexOf(n)&&a.push(n):-1!=a.indexOf(n)&&a.splice(a.indexOf(n),1),console.log(this.state.sendGroupIds)}},{key:"createGroupBuy",value:function(){console.log("in create group buy");var e=this;e.saveImage().then(function(t){var a=t.data;return e.pushMessageToGroups(a)}).then(function(){window.liff.closeWindow()})}},{key:"saveImage",value:function(){var e=new FormData;return e.append("image",document.getElementById("groupBuyImage").files[0]),b.a.post("/api/putImageToFtp",e,{headers:{"Content-Type":"multipart/form-data"}})}},{key:"pushMessageToGroups",value:function(e){return b.a.post("/api/pushMessage",{ids:this.state.sendGroupIds,message:{type:"flex",altText:"\u5718\u8cfc\u529f\u80fd",contents:{type:"bubble",hero:{type:"image",url:e,size:"full",aspectRatio:"20:13",aspectMode:"cover",action:{type:"uri",uri:"http://linecorp.com/"}},footer:{type:"box",layout:"vertical",spacing:"sm",contents:[{type:"button",style:"link",height:"sm",action:{type:"uri",label:"\u53c3\u52a0\u5718\u8cfc",uri:"http://www.google.com"}},{type:"spacer",size:"sm"}],flex:0}}}})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"container mt-3"},i.a.createElement("h1",null,"\u767c\u8d77\u8005\uff1a",this.state.user.displayName),i.a.createElement("h1",null,this.state.user.pictureUrl),i.a.createElement("p",null)," ",i.a.createElement("p",null),i.a.createElement("div",{className:"fileinput fileinput-new","data-provides":"fileinput"},i.a.createElement("div",{className:"fileinput-preview thumbnail","data-trigger":"fileinput",style:{width:"200px",height:"150px"}}),i.a.createElement("div",null,i.a.createElement("span",{className:"btn btn-default btn-file"},i.a.createElement("span",{className:"fileinput-new"},"\u9078\u64c7\u5716\u6a94"),i.a.createElement("span",{className:"fileinput-exists"},"\u91cd\u65b0\u9078\u64c7"),i.a.createElement("input",{type:"file",id:"groupBuyImage"})),i.a.createElement("a",{href:"#",className:"btn btn-default fileinput-exists","data-dismiss":"fileinput"},"\u79fb\u9664"))),i.a.createElement("div",{class:"mt-3"},i.a.createElement("table",{class:"table table-bordered"},this.state.tableHtml),i.a.createElement("button",{class:"btn btn-primary",onClick:this.createGroupBuy},"\u50b3\u9001"))))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(r.a,null,i.a.createElement("div",null,i.a.createElement(o.a,{path:"/createGroupBuy/",component:y}),i.a.createElement(o.a,{path:"/joinGroupBuy",component:v}),i.a.createElement(o.a,{path:"/sendGroupMessages",component:w}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[237,2,1]]]);
//# sourceMappingURL=main.ced0f8c4.chunk.js.map